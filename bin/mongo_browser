#!/usr/bin/env ruby

require "optparse"
require "methadone"
require "mongo_browser"

class App
  include Methadone::Main
  include Methadone::CLILogging

  main do
    info("Running on the master node #{MongoBrowser.mongodb_host}:#{MongoBrowser.mongodb_port}")
    MongoBrowser::Application.run!(port: options[:port] || 4567)
  end

  version MongoBrowser::VERSION

  on("--port PORT", "MongoBrowser port",
     "(Default: 4567)")

  on("--mongodb-host HOST", "Mongodb database host",
     "(Default: #{MongoBrowser.mongodb_host})") do |host|

    MongoBrowser.mongodb_host = host
  end

  on("--mongodb-port PORT", "Mongodb database port",
     "(Default: #{MongoBrowser.mongodb_port})") do |port|

    MongoBrowser.mongodb_port = port.to_i
  end

  use_log_level_option

  go!
end
